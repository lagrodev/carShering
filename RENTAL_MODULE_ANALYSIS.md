# ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· rental Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ Ğ¸ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ğ² Ğ²Ğ°ÑˆĞµĞ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

## ğŸ“‹ ĞĞ³Ğ»Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
1. [ĞĞ±Ñ‰Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹](#Ğ¾Ğ±Ñ‰Ğ°Ñ-Ğ¾Ñ†ĞµĞ½ĞºĞ°-ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹)
2. [ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸](#ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ-Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸)
3. [Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°](#Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹-Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·-ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾-Ñ„Ğ°Ğ¹Ğ»Ğ°)
4. [Ğ§Ñ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ](#Ñ‡Ñ‚Ğ¾-Ğ½ÑƒĞ¶Ğ½Ğ¾-Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ)
5. [ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ](#Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ-Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ)

---

## ĞĞ±Ñ‰Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ° ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
	
### âœ… Ğ§Ñ‚Ğ¾ Ñƒ Ğ²Ğ°Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:

1. **Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ°Ğ¿Ğ¾Ğº ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ DDD**:
   ```
   rental/
   â”œâ”€â”€ domain/
   â”‚   â”œâ”€â”€ model/              âœ… Ğ•ÑÑ‚ÑŒ
   â”‚   â”œâ”€â”€ valueobject/        âœ… Ğ•ÑÑ‚ÑŒ
   â”‚   â”œâ”€â”€ service/            âœ… Ğ•ÑÑ‚ÑŒ
   â”‚   â””â”€â”€ repository/         âœ… Ğ•ÑÑ‚ÑŒ
   â”œâ”€â”€ infrastructure/
   â”‚   â””â”€â”€ persistence/        âœ… Ğ•ÑÑ‚ÑŒ
   â””â”€â”€ application/            âœ… Ğ¯ ÑĞ¾Ğ·Ğ´Ğ°Ğ»
   ```

2. **Domain Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Contract** - Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ°:
   - ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ âœ…
   - Ğ¡Ñ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ `create()` Ğ¸ `restore()` âœ…
   - Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ (`confirm()`, `cancel()`, `complete()`) âœ…
   - Value Objects Ğ´Ğ»Ñ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ¾Ğ² âœ…

3. **Value Objects** - Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ñ‹:
   - `ContractId`, `ClientId`, `CarId` - Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ¸ Ğ½Ğ°Ğ´ Long âœ…
   - `RentalPeriod` - embeddable VO âœ…
   - `RentalStateType` - enum Ñ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¾Ğ¹ âœ…

4. **Mapper** - Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ âœ…

---

## ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸

### âŒ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 1: ContractDomainRepository - ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ«Ğ• Ğ¡Ğ˜Ğ“ĞĞĞ¢Ğ£Ğ Ğ«

**Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´ (ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):**
```java
public interface ContractDomainRepository {
    Contract save(Contract contract);
    Optional<Contract> findById(Contract contract);  // âŒ ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Contract Ğ²Ğ¼ĞµÑÑ‚Ğ¾ ContractId
    List<Contract> findOverlappingContracts(
        LocalDateTime start,  // âŒ ĞŸÑ€Ğ¸Ğ¼Ğ¸Ñ‚Ğ¸Ğ²Ñ‹ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Value Objects
        LocalDateTime end,    // âŒ
        Long carId,           // âŒ
        Long excludeContractId  // âŒ
    );
    void deleteById(Contract contract);  // âŒ ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Contract Ğ²Ğ¼ĞµÑÑ‚Ğ¾ ContractId
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:**

1. **`findById(Contract contract)`** - Ğ‘Ğ Ğ•Ğ”! 
   - Ğ—Ğ°Ñ‡ĞµĞ¼ Ğ¸ÑĞºĞ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚, ĞµÑĞ»Ğ¸ Ğ²Ñ‹ ÑƒĞ¶Ğµ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ»Ğ¸ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚ Ğ² Ğ¼ĞµÑ‚Ğ¾Ğ´?
   - Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ: `findById(ContractId id)`

2. **ĞŸÑ€Ğ¸Ğ¼Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ñ‚Ğ¸Ğ¿Ñ‹ (`Long`, `LocalDateTime`) Ğ² Domain Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞµ**:
   - ĞĞ°Ñ€ÑƒÑˆĞ°ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿ DDD - Domain Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¾Ğ¿ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Value Objects
   - ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° type safety - Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞ¿ÑƒÑ‚Ğ°Ñ‚ÑŒ `carId` Ğ¸ `clientId`
   - Ğ›ÑƒÑ‡ÑˆĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `CarId`, `RentalPeriod`

3. **`deleteById(Contract contract)`** - Ñ‚Ğ¾Ğ¶Ğµ ÑÑ‚Ñ€Ğ°Ğ½Ğ½Ğ¾:
   - Ğ—Ğ°Ñ‡ĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ²Ğ°Ñ‚ÑŒ Ğ²ĞµÑÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚, ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶ĞµĞ½ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ID?
   - Ğ›ÑƒÑ‡ÑˆĞµ: `delete(Contract contract)` - ĞµÑĞ»Ğ¸ Ñ…Ğ¾Ñ‚Ğ¸Ñ‚Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ, Ñ‡Ñ‚Ğ¾ ÑƒĞ´Ğ°Ğ»ÑĞµÑ‚ÑÑ

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚:**
```java
public interface ContractDomainRepository {
    // âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ/Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
    Contract save(Contract contract);
    
    // âœ… ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ğ¾ ID
    Optional<Contract> findById(ContractId contractId);
    
    // âœ… ĞŸĞ¾Ğ¸ÑĞº Ñ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸ĞµĞ¹
    Page<Contract> findByClientId(ClientId clientId, Pageable pageable);
    
    // âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿Ñ€Ğ°Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°
    Optional<Contract> findByIdAndClientId(ContractId contractId, ClientId clientId);
    
    // âœ… Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°: Ğ½Ğ°Ğ¹Ñ‚Ğ¸ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹
    List<Contract> findActiveContractsForCarInPeriod(CarId carId, RentalPeriod period);
    
    // âœ… Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°: Ğ½Ğ°Ğ¹Ñ‚Ğ¸ Ğ¿ĞµÑ€ĞµÑĞµĞºĞ°ÑÑ‰Ğ¸ĞµÑÑ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñ‹
    List<Contract> findOverlappingContracts(
        CarId carId, 
        RentalPeriod period, 
        ContractId excludeContractId
    );
    
    // âœ… Soft delete
    void delete(Contract contract);
}
```

---

### âŒ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 2: ContractRepositoryAdapter - ĞŸĞ£Ğ¡Ğ¢ĞĞ¯ Ğ Ğ•ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯

**Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´ (ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):**
```java
@Repository
@RequiredArgsConstructor
public class ContractRepositoryAdapter implements ContractDomainRepository {
    private final ContractMapper mapper;
    private final ContractRepository jpaRepository;

    @Override
    public Contract save(Contract contract) {
        ContractJpaEntity contractJpaEntity = new ContractJpaEntity();  // âŒ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ»Ğ¸ Ğ¿ÑƒÑÑ‚ÑƒÑ entity
        return null;  // âŒ Ğ’ĞµÑ€Ğ½ÑƒĞ»Ğ¸ null
    }

    @Override
    public Optional<Contract> findById(Contract contract) {  // âŒ ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ°
        return Optional.empty();  // âŒ Ğ’ÑĞµĞ³Ğ´Ğ° Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ Optional
    }

    @Override
    public List<Contract> findOverlappingContracts(LocalDateTime start, LocalDateTime end, 
                                                   Long carId, Long excludeContractId) {
        return List.of();  // âŒ Ğ’ÑĞµĞ³Ğ´Ğ° Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº
    }

    @Override
    public void deleteById(Contract contract) {
        // âŒ ĞŸÑƒÑÑ‚Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
    }
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ ĞšĞĞ¢ĞĞ¡Ğ¢Ğ ĞĞ¤Ğ˜Ğ§Ğ•Ğ¡ĞšĞ˜ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:**

1. **`save()` Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ `null`**:
   - ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ ÑƒĞ¿Ğ°Ğ´Ñ‘Ñ‚ Ñ `NullPointerException` Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚
   - Ğ’Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ»Ğ¸ Ğ¿ÑƒÑÑ‚ÑƒÑ `ContractJpaEntity`, Ğ½Ğµ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ğ»Ğ¸ ĞµÑ‘ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
   - ĞĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ»Ğ¸ `mapper.toEntity(contract)` Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ğ¸

2. **`findById()` Ğ²ÑĞµĞ³Ğ´Ğ° Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ `Optional.empty()`**:
   - ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ ĞĞ˜ĞšĞĞ“Ğ”Ğ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´Ñ‘Ñ‚ Ğ½Ğ¸ Ğ¾Ğ´Ğ¸Ğ½ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚
   - Ğ›ÑĞ±Ğ°Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ñ‡Ñ‚ĞµĞ½Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ»Ğ¸Ñ‚ÑÑ

3. **`findOverlappingContracts()` Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ ÑĞ¿Ğ¸ÑĞ¾Ğº**:
   - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ ĞĞ˜ĞšĞĞ“Ğ”Ğ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´Ñ‘Ñ‚ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ğ¹
   - ĞœĞ¾Ğ¶Ğ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ 10 ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ğ¾Ğ² Ğ½Ğ° Ğ¾Ğ´Ğ½Ñƒ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñƒ Ğ² Ğ¾Ğ´Ğ½Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ - Ğ‘ĞĞ“!

4. **`deleteById()` Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ´ĞµĞ»Ğ°ĞµÑ‚**:
   - ĞšĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñ‹ ĞĞ˜ĞšĞĞ“Ğ”Ğ Ğ½Ğµ Ğ±ÑƒĞ´ÑƒÑ‚ ÑƒĞ´Ğ°Ğ»ÑÑ‚ÑŒÑÑ

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```java
@Repository
@RequiredArgsConstructor
public class ContractRepositoryAdapter implements ContractDomainRepository {
    
    private final ContractMapper mapper;
    private final ContractRepository jpaRepository;

    @Override
    public Contract save(Contract contract) {
        // 1. Domain -> JPA Entity (Ñ‡ĞµÑ€ĞµĞ· mapper)
        ContractJpaEntity entity = mapper.toEntity(contract);
        
        // 2. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ² Ğ‘Ğ” Ñ‡ĞµÑ€ĞµĞ· JPA Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
        ContractJpaEntity savedEntity = jpaRepository.save(entity);
        
        // 3. JPA Entity -> Domain (Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾ Ñ‡ĞµÑ€ĞµĞ· mapper)
        return mapper.toDomain(savedEntity);
    }

    @Override
    public Optional<Contract> findById(ContractId contractId) {
        // 1. ĞŸĞ¾Ğ¸ÑĞº JPA entity Ğ¿Ğ¾ Long ID
        Optional<ContractJpaEntity> entityOptional = jpaRepository.findById(contractId.getValue());
        
        // 2. ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ğ² Domain Ğ¾Ğ±ÑŠĞµĞºÑ‚, ĞµÑĞ»Ğ¸ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
        return entityOptional.map(mapper::toDomain);
    }

    @Override
    public List<Contract> findActiveContractsForCarInPeriod(CarId carId, RentalPeriod period) {
        // 1. Ğ’Ñ‹Ğ·Ğ¾Ğ² JPA Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ° Ñ Ğ¿Ñ€Ğ¸Ğ¼Ğ¸Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¼Ğ¸ Ñ‚Ğ¸Ğ¿Ğ°Ğ¼Ğ¸
        List<ContractJpaEntity> entities = jpaRepository.findOverlappingContracts(
            period.getStartDate(),      // LocalDateTime Ğ¸Ğ· Value Object
            period.getEndDate(),        // LocalDateTime Ğ¸Ğ· Value Object
            carId.getValue(),           // Long Ğ¸Ğ· Value Object
            null                        // ĞĞµ Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ½Ğ¸ Ğ¾Ğ´Ğ¸Ğ½ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚
        );
        
        // 2. ĞœĞ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ ÑĞ¿Ğ¸ÑĞºĞ° JPA entities Ğ² Domain Ğ¾Ğ±ÑŠĞµĞºÑ‚Ñ‹
        return entities.stream()
            .map(mapper::toDomain)
            .collect(Collectors.toList());
    }

    @Override
    public void delete(Contract contract) {
        // Ğ’ DDD ĞĞ• ÑƒĞ´Ğ°Ğ»ÑĞµĞ¼ Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸!
        // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ soft delete Ñ‡ĞµÑ€ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
        contract.cancel();  // Ğ˜Ğ»Ğ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ markAsDeleted()
        save(contract);
    }
}
```

---

### âŒ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 3: RentalDomainService - ĞĞ•Ğ”ĞĞ¡Ğ¢ĞĞ¢ĞĞ§ĞĞ Ğ›ĞĞ“Ğ˜ĞšĞ˜

**Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´ (ĞĞ•ĞŸĞĞ›ĞĞ«Ğ™):**
```java
@Service
public class RentalDomainService {
    // âŒ ĞĞµÑ‚ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ĞµĞ² - ĞºĞ°Ğº Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ?
    
    public Money calculateTotalCost(Money dailyRate, int durationInDays) {
        return dailyRate.multiply(durationInDays);  // âœ… Ğ­Ñ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
    }

    public boolean canCanceledWithoutFee(Contract contract) {
        long daysUntilStart = ChronoUnit.DAYS.between(
            LocalDateTime.now(),
            contract.getRentalPeriod().getStartDate()
        );
        return daysUntilStart > 5;  // âœ… Ğ­Ñ‚Ğ¾ Ñ‚Ğ¾Ğ¶Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
    }
    
    // âŒ ĞĞ•Ğ¢ Ğ¡ĞĞœĞĞ™ Ğ’ĞĞ–ĞĞĞ™ Ğ›ĞĞ“Ğ˜ĞšĞ˜ - Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹!
}
```

**Ğ§Ñ‚Ğ¾ Ğ½Ğµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚:**

1. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹** - ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ!
   ```java
   // âŒ Ğ£ Ğ²Ğ°Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ° ĞĞ•Ğ¢!
   public void validateCarAvailability(CarId carId, RentalPeriod period, ContractId excludeContractId) {
       // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ñ Ğ´Ğ°Ñ‚
   }
   ```

2. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· Domain Service**:
   ```java
   // âŒ Ğ£ Ğ²Ğ°Ñ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ° ĞĞ•Ğ¢!
   public Contract createRental(ClientId clientId, CarId carId, RentalPeriod period, Money dailyRate) {
       // 1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸
       // 2. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
       // 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ
   }
   ```

3. **Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ ÑˆÑ‚Ñ€Ğ°Ñ„Ğ¾Ğ² Ğ·Ğ° Ğ¾Ñ‚Ğ¼ĞµĞ½Ñƒ**:
   ```java
   // âŒ Ğ£ Ğ²Ğ°Ñ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°, Ğ½Ğ¾ Ğ½ĞµÑ‚ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ° ÑÑƒĞ¼Ğ¼Ñ‹ ÑˆÑ‚Ñ€Ğ°Ñ„Ğ°
   public Money calculateCancellationFee(Contract contract) {
       if (canCancelWithoutFee(contract)) {
           return Money.ZERO;
       }
       // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ° ÑˆÑ‚Ñ€Ğ°Ñ„Ğ°
   }
   ```

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
```java
@Service
@RequiredArgsConstructor
public class RentalDomainService {
    
    private final ContractDomainRepository contractRepository;  // âœ… ĞÑƒĞ¶ĞµĞ½ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹!
    
    /**
     * Ğ‘Ğ˜Ğ—ĞĞ•Ğ¡-ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ğ° Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸
     */
    public Contract createRental(ClientId clientId, CarId carId, 
                                  RentalPeriod period, Money dailyRate) {
        // 1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹
        validateCarAvailability(carId, period, null);
        
        // 2. Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ° Ğ°Ñ€ĞµĞ½Ğ´Ñ‹
        validateRentalPeriod(period);
        
        // 3. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ‚Ğ°
        return Contract.create(clientId, carId, period, dailyRate);
    }
    
    /**
     * Ğ‘Ğ˜Ğ—ĞĞ•Ğ¡-ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹ (Ğ¡ĞĞœĞĞ• Ğ’ĞĞ–ĞĞĞ•!)
     */
    public void validateCarAvailability(CarId carId, RentalPeriod requestedPeriod, 
                                       ContractId excludeContractId) {
        List<Contract> overlappingContracts;
        
        if (excludeContractId != null) {
            // ĞŸÑ€Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğ¸ - Ğ¸ÑĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰Ğ¸Ğ¹ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚
            overlappingContracts = contractRepository.findOverlappingContracts(
                carId, requestedPeriod, excludeContractId
            );
        } else {
            // ĞŸÑ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ - Ğ¸Ñ‰ĞµĞ¼ Ğ²ÑĞµ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ
            overlappingContracts = contractRepository.findActiveContractsForCarInPeriod(
                carId, requestedPeriod
            );
        }
        
        // Ğ’ĞĞ–ĞĞ: Ğ•ÑĞ»Ğ¸ Ğ½Ğ°ÑˆĞ»Ğ¸ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ñ - Ğ±Ñ€Ğ¾ÑĞ°ĞµĞ¼ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
        if (!overlappingContracts.isEmpty()) {
            throw new CarNotAvailableException(
                "Car is not available for the requested period. Found " + 
                overlappingContracts.size() + " overlapping contracts."
            );
        }
    }
    
    /**
     * Ğ‘Ğ˜Ğ—ĞĞ•Ğ¡-ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ: Ğ Ğ°ÑÑ‡Ñ‘Ñ‚ ÑˆÑ‚Ñ€Ğ°Ñ„Ğ° Ğ·Ğ° Ğ¾Ñ‚Ğ¼ĞµĞ½Ñƒ
     */
    public Money calculateCancellationFee(Contract contract) {
        if (canCancelWithoutFee(contract)) {
            return Money.zeroRubles();  // Ğ‘ĞµĞ· ÑˆÑ‚Ñ€Ğ°Ñ„Ğ°
        }
        
        long daysUntilStart = ChronoUnit.DAYS.between(
            LocalDateTime.now(),
            contract.getRentalPeriod().getStartDate()
        );
        
        // Ğ¨Ñ‚Ñ€Ğ°Ñ„ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ñ‚ Ğ¾Ñ‚ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ´Ğ¾ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ°Ñ€ĞµĞ½Ğ´Ñ‹
        if (daysUntilStart >= 3) {
            // 3-5 Ğ´Ğ½ĞµĞ¹ - 25% Ğ¾Ñ‚ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
            return contract.getTotalCost().multiply(BigDecimal.valueOf(0.25));
        } else if (daysUntilStart >= 1) {
            // 1-2 Ğ´Ğ½Ñ - 50% Ğ¾Ñ‚ ÑÑ‚Ğ¾Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
            return contract.getTotalCost().multiply(BigDecimal.valueOf(0.50));
        } else {
            // ĞœĞµĞ½ĞµĞµ ÑÑƒÑ‚Ğ¾Ğº - 100% ÑˆÑ‚Ñ€Ğ°Ñ„
            return contract.getTotalCost();
        }
    }
    
    /**
     * Ğ‘Ğ˜Ğ—ĞĞ•Ğ¡-ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ: Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ° Ğ°Ñ€ĞµĞ½Ğ´Ñ‹
     */
    private void validateRentalPeriod(RentalPeriod period) {
        // ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ€Ğ¾Ğº Ğ°Ñ€ĞµĞ½Ğ´Ñ‹ - 1 Ñ‡Ğ°Ñ
        long durationMinutes = ChronoUnit.MINUTES.between(
            period.getStartDate(), 
            period.getEndDate()
        );
        
        if (durationMinutes < 60) {
            throw new IllegalArgumentException("Minimum rental period is 1 hour");
        }
        
        // ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ€Ğ¾Ğº Ğ°Ñ€ĞµĞ½Ğ´Ñ‹ - 90 Ğ´Ğ½ĞµĞ¹
        if (period.getDurationInDays() > 90) {
            throw new IllegalArgumentException("Maximum rental period is 90 days");
        }
        
        // ĞĞµĞ»ÑŒĞ·Ñ Ğ°Ñ€ĞµĞ½Ğ´Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾Ğ¼
        if (period.getStartDate().isBefore(LocalDateTime.now())) {
            throw new IllegalArgumentException("Cannot create rental in the past");
        }
    }
}
```

---

### âŒ ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 4: ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Application Service

**Ğ§Ñ‚Ğ¾ Ğ½Ğµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚:**

Ğ£ Ğ²Ğ°Ñ ĞĞ•Ğ¢ Application Service ÑĞ»Ğ¾Ñ! Ğ­Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°, Ğ¿Ğ¾Ñ‚Ğ¾Ğ¼Ñƒ Ñ‡Ñ‚Ğ¾:

1. **ĞšÑ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ use cases?**
   - ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€ ĞĞ• Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ·Ğ½Ğ°Ñ‚ÑŒ Ğ¾ Domain Services Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ
   - ĞÑƒĞ¶ĞµĞ½ Ğ¿Ñ€Ğ¾Ğ¼ĞµĞ¶ÑƒÑ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ÑĞ»Ğ¾Ğ¹

2. **ĞšÑ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑÑ‚ÑŒ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸ÑĞ¼Ğ¸?**
   - Domain Services ĞĞ• Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ¸Ğ¼ĞµÑ‚ÑŒ `@Transactional`
   - Application Service ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸ÑĞ¼Ğ¸

3. **ĞšÑ‚Ğ¾ Ğ±ÑƒĞ´ĞµÑ‚ ĞºĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ‚Ğ¾Ğ²?**
   - ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ğ° Ğ½ÑƒĞ¶Ğ½Ğ¾:
     - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚
     - ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
     - ĞĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
     - ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°:**
```java
@Service
@RequiredArgsConstructor
@Transactional
public class ContractApplicationService {
    
    private final RentalDomainService rentalDomainService;
    private final ContractDomainRepository contractRepository;
    // private final NotificationService notificationService;
    // private final EventPublisher eventPublisher;
    
    /**
     * USE CASE: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚
     */
    public ContractId createContract(CreateContractRequest request) {
        log.info("Creating contract for client {} and car {}", 
            request.getClientId(), request.getCarId());
        
        // 1. ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ¼Ğ¸Ñ‚Ğ¸Ğ²Ğ¾Ğ² Ğ² Value Objects
        ClientId clientId = new ClientId(request.getClientId());
        CarId carId = new CarId(request.getCarId());
        
        // 2. Ğ’Ñ‹Ğ·Ğ¾Ğ² Domain Service (Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°)
        Contract contract = rentalDomainService.createRental(
            clientId, carId, request.getPeriod(), request.getDailyRate()
        );
        
        // 3. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ
        contract = contractRepository.save(contract);
        
        // 4. Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğµ ÑÑ„Ñ„ĞµĞºÑ‚Ñ‹ (ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ, ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ)
        // notificationService.sendContractCreated(contract);
        // eventPublisher.publish(new ContractCreatedEvent(contract));
        
        return contract.getId();
    }
    
    /**
     * USE CASE: ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚
     */
    public void confirmContract(ContractId contractId) {
        // 1. Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°
        Contract contract = contractRepository.findById(contractId)
            .orElseThrow(() -> new ResourceNotFoundException("Contract not found"));
        
        // 2. Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° (Ğ² Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ‚Ğµ)
        contract.confirm();
        
        // 3. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ
        contractRepository.save(contract);
        
        // 4. Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
        // notificationService.sendContractConfirmed(contract);
    }
    
    // ... Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ use cases
}
```

---

## Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ°

### 1. Contract.java (Domain Model) âœ…

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ¥ĞĞ ĞĞ¨Ğ** (Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ²)

```java
@Getter
public class Contract {
    // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: final Ğ´Ğ»Ñ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²
    private final ContractId id;
    private final ClientId clientId;
    private final CarId carId;
    
    // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: Ğ¼ÑƒÑ‚Ğ°Ğ±ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
    private RentalPeriod rentalPeriod;
    private Money totalCost;
    private RentalStateType state;
    private String comment;
    
    // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ factory method
    public static Contract create(ClientId clientId, CarId carId,
                                  RentalPeriod period, Money dailyRate) {
        Money total = dailyRate.multiply(period.getDurationInDays());
        return new Contract(null, clientId, carId, period, total,
                RentalStateType.PENDING, null);
    }
    
    // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€
    private Contract(ContractId id, ClientId clientId, CarId cardId,
                     RentalPeriod rentalPeriod, Money totalCost,
                     RentalStateType state, String comment) {
        // ...
    }
    
    // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: restore Ğ´Ğ»Ñ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ· Ğ‘Ğ”
    public static Contract restore(ContractId id, ClientId clientId, CarId carId,
                                   RentalPeriod period, Money totalCost,
                                   RentalStateType state, String comment) {
        return new Contract(id, clientId, carId, period, totalCost, state, comment);
    }
    
    // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ² Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ‚Ğµ
    public void confirm() {
        if (!state.canTransitionTo(RentalStateType.CONFIRMED)) {
            throw new InvalidContractStateException("Cannot confirm");
        }
        state = RentalStateType.CONFIRMED;
    }
    
    // ... Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹
}
```

**Ğ§Ñ‚Ğ¾ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ñ‚ÑŒ:**

1. **Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸ĞµĞ²**:
   ```java
   public void addComment(String comment) {
       if (comment != null && !comment.isBlank()) {
           this.comment = (this.comment != null ? this.comment + "\n" : "") + comment;
       }
   }
   ```

2. **Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ soft delete**:
   ```java
   private boolean deleted;
   private LocalDateTime deletedAt;
   
   public void markAsDeleted() {
       if (!state.isTerminal()) {
           throw new IllegalStateException("Can only delete terminal contracts");
       }
       this.deleted = true;
       this.deletedAt = LocalDateTime.now();
   }
   ```

---

### 2. RentalStateType.java (Enum) âœ…

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: ĞĞ¢Ğ›Ğ˜Ğ§ĞĞ** (Ğ¿Ğ¾ÑĞ»Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ `isUpdatable()`)

```java
@Getter
public enum RentalStateType {
    PENDING("ĞĞ¶Ğ¸Ğ´Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ñ"){
        @Override
        public boolean canTransitionTo(RentalStateType target) {
            return target == CONFIRMED || target == CANCELLATION_REQUESTED;
        }
        
        @Override
        public boolean isUpdatable() {
            return true;  // âœ… ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ´Ğ°Ñ‚Ñ‹
        }
    },
    
    CONFIRMED("ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´Ñ‘Ğ½"){
        @Override
        public boolean canTransitionTo(RentalStateType target) {
            return target == ACTIVE || target == CANCELLATION_REQUESTED;
        }
        
        @Override
        public boolean isUpdatable() {
            return true;  // âœ… ĞœĞ¾Ğ¶Ğ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ´Ğ°Ñ‚Ñ‹ Ğ´Ğ¾ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°
        }
    },
    
    ACTIVE("ĞĞºÑ‚Ğ¸Ğ²ĞµĞ½") {
        @Override
        public boolean canTransitionTo(RentalStateType target) {
            return target == COMPLETED || target == CANCELLATION_REQUESTED;
        }
        
        @Override
        public boolean isUpdatable() {
            return false;  // âœ… ĞĞµĞ»ÑŒĞ·Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ÑÑ‚ÑŒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½ÑƒÑ Ğ°Ñ€ĞµĞ½Ğ´Ñƒ
        }
    },
    
    // ... Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹
    
    public abstract boolean canTransitionTo(RentalStateType target);
    public abstract boolean isUpdatable();
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:**

1. **State Pattern** - ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ğ·Ğ½Ğ°ĞµÑ‚ ÑĞ²Ğ¾Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¿ĞµÑ€ĞµÑ…Ğ¾Ğ´Ğ¾Ğ²
2. **Ğ˜Ğ½ĞºĞ°Ğ¿ÑÑƒĞ»ÑÑ†Ğ¸Ñ** - Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ enum, Ğ½Ğµ Ñ€Ğ°Ğ·Ğ¼Ğ°Ğ·Ğ°Ğ½Ğ° Ğ¿Ğ¾ ĞºĞ¾Ğ´Ñƒ
3. **Ğ Ğ°ÑÑˆĞ¸Ñ€ÑĞµĞ¼Ğ¾ÑÑ‚ÑŒ** - Ğ»ĞµĞ³ĞºĞ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ‚ÑƒÑ
4. **JPA Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ°** - `@Enumerated(EnumType.STRING)` Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¸Ğ· ĞºĞ¾Ñ€Ğ¾Ğ±ĞºĞ¸

---

### 3. ContractMapper.java âœ…

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: ĞĞ¢Ğ›Ğ˜Ğ§ĞĞ** (Ğ¿Ğ¾ÑĞ»Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğ¹)

```java
@Mapper(componentModel = MappingConstants.ComponentModel.SPRING)
public abstract class ContractMapper {

    // âœ… Domain -> JPA Entity
    @Mapping(source = "id.value", target = "id")
    @Mapping(source = "clientId.value", target = "clientId")
    @Mapping(source = "cardId.value", target = "carId")
    @Mapping(source = "rentalPeriod", target = "period")
    // ...
    public abstract ContractJpaEntity toEntity(Contract contract);

    // âœ… JPA Entity -> Domain (Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³Ğ°Ğ¼Ğ¸)
    @Mapping(target = "id", source = "id", qualifiedByName = "toContractId")
    @Mapping(target = "clientId", source = "clientId", qualifiedByName = "toClientId")
    @Mapping(target = "cardId", source = "carId", qualifiedByName = "toCarId")
    // ...
    public abstract Contract toDomain(ContractJpaEntity entity);

    // âœ… Ğ¥ĞµĞ»Ğ¿ĞµÑ€Ñ‹ Ğ´Ğ»Ñ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ°Ñ†Ğ¸Ğ¸ ID
    @Named("toContractId")
    protected ContractId toContractId(Long id) {
        return id != null ? new ContractId(id) : null;
    }

    // âœ… ObjectFactory Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· restore()
    @ObjectFactory
    protected Contract createContract(ContractJpaEntity entity) {
        return Contract.restore(
            toContractId(entity.getId()),
            toClientId(entity.getClientId()),
            toCarId(entity.getCarId()),
            entity.getPeriod(),
            entity.getTotalCost(),
            entity.getState(),
            entity.getComment()
        );
    }
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:**

1. **@ObjectFactory** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ `restore()` Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Domain Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°
2. **Value Objects** - Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Long â†” ContractId
3. **Ğ Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸** - Ğ¼Ğ°Ğ¿Ğ¿ĞµÑ€ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚, Ğ½Ğµ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¸

---

### 4. ContractJpaEntity.java âœ…

**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: Ğ¥ĞĞ ĞĞ¨Ğ**

```java
@Entity
@Table(name = "contract", schema = "car_rental")
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class ContractJpaEntity {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Embedded
    @AttributeOverrides({
        @AttributeOverride(name = "startDate", column = @Column(name = "data_start")),
        @AttributeOverride(name = "endDate", column = @Column(name = "data_end")),
        @AttributeOverride(name = "durationMinutes", column = @Column(name = "duration_minutes"))
    })
    private RentalPeriod period;  // âœ… Embedded Value Object

    @Embedded
    @AttributeOverrides({
        @AttributeOverride(name = "amount", column = @Column(name = "total_cost")),
        @AttributeOverride(name = "currencyCode", column = @Column(name = "currency"))
    })
    private Money totalCost;  // âœ… Embedded Value Object

    @Column(name = "client_id", nullable = false)
    private Long clientId;  // âœ… Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ID, ĞĞ• @ManyToOne

    @Column(name = "car_id", nullable = false)
    private Long carId;  // âœ… Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ID, ĞĞ• @ManyToOne

    @Enumerated(EnumType.STRING)
    @Column(name = "state")
    private RentalStateType state;  // âœ… Enum, ĞĞ• Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°
}
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:**

1. **Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ID Ğ´Ğ»Ñ ÑĞ²ÑĞ·ĞµĞ¹** - Ğ½ĞµÑ‚ `@ManyToOne`, ÑĞ¾Ğ±Ğ»ÑĞ´Ğ°ĞµĞ¼ Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ‚Ğ¾Ğ²
2. **Embedded Value Objects** - `RentalPeriod` Ğ¸ `Money` Ğ²ÑÑ‚Ñ€Ğ°Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ Ğ² Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñƒ
3. **Enum ĞºĞ°Ğº ÑÑ‚Ñ€Ğ¾ĞºĞ°** - `@Enumerated(EnumType.STRING)` Ğ´Ğ»Ñ `RentalStateType`

---

## Ğ§Ñ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ

### Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğ¹ Ğ¿Ğ¾ Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚Ñƒ:

#### ğŸ”´ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ (ÑĞ»Ğ¾Ğ¼Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ):

1. **ContractRepositoryAdapter.save()** - Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ
2. **ContractRepositoryAdapter.findById()** - Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ¾Ğ¸ÑĞº
3. **ContractRepositoryAdapter.findOverlappingContracts()** - Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ğ¹
4. **ContractDomainRepository** - Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ñ‹ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ² (ContractId Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Contract)
5. **RentalDomainService** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ°ÑˆĞ¸Ğ½Ñ‹

#### ğŸŸ¡ Ğ’ĞĞ–ĞĞ (Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ» Ğ½Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾):

6. **RentalDomainService** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚ ÑˆÑ‚Ñ€Ğ°Ñ„Ğ¾Ğ²
7. **RentalDomainService** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ° Ğ°Ñ€ĞµĞ½Ğ´Ñ‹
8. **Money class** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ `divide()` Ğ¸ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñƒ `ZERO`
9. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ**: `CarNotAvailableException`, `ResourceNotFoundException`
10. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Application Service** Ğ´Ğ»Ñ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ use cases

#### ğŸŸ¢ Ğ–Ğ•Ğ›ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ (ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ñ‚ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ¾):

11. **Contract** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ´Ğ»Ñ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸ĞµĞ² Ğ¸ soft delete
12. **RentalPeriod** - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ `getDurationInMinutes()`
13. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ REST ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€** Ğ´Ğ»Ñ API
14. **Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ unit-Ñ‚ĞµÑÑ‚Ñ‹** Ğ´Ğ»Ñ Domain ÑĞ»Ğ¾Ñ

---

## ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ

### Ğ¯ ÑƒĞ¶Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ» Ğ´Ğ»Ñ Ğ²Ğ°Ñ:

1. âœ… **ContractDomainRepository** - Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ°Ğ¼Ğ¸
2. âœ… **RentalDomainService** - Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¾Ğ¹
3. âœ… **ContractRepositoryAdapter** - Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹
4. âœ… **ContractApplicationService** - Ğ´Ğ»Ñ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ use cases
5. âœ… **Application DTOs** - CreateContractRequest, UpdateContractDatesRequest, ContractDetailsDto

### Ğ§Ñ‚Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ²Ğ°Ğ¼:

1. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ**:
   ```java
   // exceptions/custom/CarNotAvailableException.java
   public class CarNotAvailableException extends RuntimeException {
       public CarNotAvailableException(String message) {
           super(message);
       }
   }
   
   // exceptions/custom/ResourceNotFoundException.java
   public class ResourceNotFoundException extends RuntimeException {
       public ResourceNotFoundException(String message) {
           super(message);
       }
   }
   ```

2. **Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Money class**:
   ```java
   public class Money {
       public static final Money ZERO = Money.of(BigDecimal.ZERO, "RUB");
       
       public Money divide(long divisor) {
           return new Money(this.amount.divide(
               BigDecimal.valueOf(divisor), 
               RoundingMode.HALF_UP
           ), this.currencyCode);
       }
       
       public Money multiply(BigDecimal factor) {
           return new Money(this.amount.multiply(factor), this.currencyCode);
       }
   }
   ```

3. **Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ RentalPeriod**:
   ```java
   public long getDurationInMinutes() {
       return ChronoUnit.MINUTES.between(startDate, endDate);
   }
   
   public boolean overlaps(RentalPeriod other) {
       return this.startDate.isBefore(other.endDate) && 
              this.endDate.isAfter(other.startDate);
   }
   ```

4. **Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ REST ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€**:
   ```java
   @RestController
   @RequestMapping("/api/contracts")
   @RequiredArgsConstructor
   public class ContractController {
       
       private final ContractApplicationService contractService;
       
       @PostMapping
       public ResponseEntity<ContractId> createContract(
           @RequestBody @Valid CreateContractApiRequest request,
           @AuthenticationPrincipal UserDetails userDetails
       ) {
           CreateContractRequest serviceRequest = // mapper
           ContractId contractId = contractService.createContract(serviceRequest);
           return ResponseEntity.ok(contractId);
       }
       
       // ... Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ endpoints
   }
   ```

---

## Ğ˜Ñ‚Ğ¾Ğ³Ğ¾Ğ²Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ñ‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     API LAYER (REST)                        â”‚
â”‚                  ContractController                         â”‚
â”‚  - POST   /api/contracts                                    â”‚
â”‚  - GET    /api/contracts/{id}                               â”‚
â”‚  - PUT    /api/contracts/{id}/confirm                       â”‚
â”‚  - DELETE /api/contracts/{id}/cancel                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              APPLICATION LAYER                              â”‚
â”‚          ContractApplicationService                         â”‚
â”‚  - createContract(request)                                  â”‚
â”‚  - confirmContract(id)                                      â”‚
â”‚  - requestCancellation(id, clientId)                        â”‚
â”‚  - @Transactional                                           â”‚
â”‚  - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸ÑĞ¼Ğ¸                                   â”‚
â”‚  - ĞšĞ¾Ğ¾Ñ€Ğ´Ğ¸Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ°Ğ³Ñ€ĞµĞ³Ğ°Ñ‚Ğ¾Ğ²                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  DOMAIN LAYER                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Contract (Aggregate Root)                           â”‚    â”‚
â”‚  â”‚  - confirm()                                        â”‚    â”‚
â”‚  â”‚  - cancel()                                         â”‚    â”‚
â”‚  â”‚  - complete()                                       â”‚    â”‚
â”‚  â”‚  - updateDates()                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ RentalDomainService                                 â”‚    â”‚
â”‚  â”‚  - createRental()                                   â”‚    â”‚
â”‚  â”‚  - validateCarAvailability() â† ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ!           â”‚    â”‚
â”‚  â”‚  - calculateCancellationFee()                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ContractDomainRepository (interface)                â”‚    â”‚
â”‚  â”‚  - save(contract)                                   â”‚    â”‚
â”‚  â”‚  - findById(id)                                     â”‚    â”‚
â”‚  â”‚  - findOverlappingContracts()                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾ Ğ²
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            INFRASTRUCTURE LAYER                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ContractRepositoryAdapter                           â”‚    â”‚
â”‚  â”‚  - mapper.toEntity()     â† Domain -> JPA           â”‚    â”‚
â”‚  â”‚  - jpaRepository.save()  â† Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ‘Ğ”             â”‚    â”‚
â”‚  â”‚  - mapper.toDomain()     â† JPA -> Domain           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ContractRepository (Spring Data JPA)                â”‚    â”‚
â”‚  â”‚  extends JpaRepository<ContractJpaEntity, Long>     â”‚    â”‚
â”‚  â”‚  - findOverlappingContracts() â† @Query             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ContractJpaEntity                                   â”‚    â”‚
â”‚  â”‚  - @Entity                                          â”‚    â”‚
â”‚  â”‚  - Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Long ID Ğ´Ğ»Ñ ÑĞ²ÑĞ·ĞµĞ¹                       â”‚    â”‚
â”‚  â”‚  - @Embedded Value Objects                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ContractMapper (MapStruct)                          â”‚    â”‚
â”‚  â”‚  - toEntity(Contract)                               â”‚    â”‚
â”‚  â”‚  - toDomain(ContractJpaEntity)                      â”‚    â”‚
â”‚  â”‚  - @ObjectFactory createContract()                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE                                 â”‚
â”‚  contract table                                             â”‚
â”‚  - id (PK)                                                  â”‚
â”‚  - client_id (FK â†’ client.id)                               â”‚
â”‚  - car_id (FK â†’ car.id)                                     â”‚
â”‚  - state (VARCHAR) â† enum                                   â”‚
â”‚  - data_start, data_end                                     â”‚
â”‚  - total_cost, currency                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Ğ’Ñ‹Ğ²Ğ¾Ğ´Ñ‹

### âœ… Ğ§Ñ‚Ğ¾ Ñƒ Ğ²Ğ°Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:

1. Domain Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Contract - Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾
2. Value Objects - Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾
3. Enum RentalStateType - Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾ (Ğ¿Ğ¾ÑĞ»Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ isUpdatable)
4. Mapper - Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
5. Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ğ°Ğ¿Ğ¾Ğº - ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ DDD

### âŒ Ğ§Ñ‚Ğ¾ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:

1. **ContractRepositoryAdapter** - Ğ¿ÑƒÑÑ‚Ñ‹Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ñ‹, Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ÑÑ‚ null/empty
2. **ContractDomainRepository** - Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ñ‹ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ¾Ğ²
3. **RentalDomainService** - Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸
4. **Application Service** - Ğ²Ğ¾Ğ¾Ğ±Ñ‰Ğµ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚

### ğŸ¯ Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ»ÑŒÑˆĞµ:

1. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ¼Ğ¾Ğ¸ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹ (Ñ Ğ¸Ñ… ÑĞ¾Ğ·Ğ´Ğ°Ğ»)
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°ÑÑ‰Ğ¸Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
3. Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ Money Ğ¸ RentalPeriod
4. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ REST ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€
5. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ unit-Ñ‚ĞµÑÑ‚Ñ‹

**ĞĞ±Ñ‰Ğ°Ñ Ğ¾Ñ†ĞµĞ½ĞºĞ°: 6/10** - ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ, Ğ½Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ infrastructure ÑĞ»Ğ¾Ñ Ñ„Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚, Ñ‡Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ²ÑÑ‘ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ½ĞµÑ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¼.

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¼Ğ½Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ»Ñ‹ ĞºĞ°Ğº reference Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸! ğŸš€

---

## ğŸ” ĞĞ‘ĞĞĞ’Ğ›Ğ•ĞĞ˜Ğ•: ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ²Ğ°ÑˆĞµĞ¹ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ĞµĞ²

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ContractDomainRepository

**Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´:**
```java
public interface ContractDomainRepository {
    // Save or update a contract
    Contract save(Contract contract);

    // Find a contract by its ID
    Optional<Contract> findById(ContractId contractId);

    // Find contracts by client ID with pagination
    Page<Contract> findByClientId(ClientId clientId, Pageable pageable);

    // Find overlapping contracts for a given rental period and car, excluding a specific contract ID
    List<Contract> findOverlappingContracts(RentalPeriod rentalPeriod,
                                            CarId carId, ContractId excludeContractId);

    // Find active contracts for a specific car within a given rental period
    List<Contract> findByActiveContractsForCarInPeriod(CarId carId, RentalPeriod period);

    // Delete a contract by its ID
    void deleteById(ContractId contractId);
}
```

#### âœ… Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:

1. **Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚Ğµ Value Objects** - `ContractId`, `ClientId`, `CarId`, `RentalPeriod` âœ…
2. **ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ñ‹** - `findById(ContractId)` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ `findById(Contract)` âœ…
3. **Optional Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ°** - `Optional<Contract> findById()` âœ…
4. **ĞŸĞ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ** - `Page<Contract> findByClientId()` âœ…
5. **Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğµ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸** - Ğ¿Ğ¾Ğ½ÑÑ‚Ğ½Ğ¾, Ñ‡Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ âœ…

#### âŒ Ğ§Ñ‚Ğ¾ Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑƒĞ»ÑƒÑ‡ÑˆĞ¸Ñ‚ÑŒ:

1. **ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ° `findByActiveContractsForCarInPeriod`** - Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğµ "By":
   ```java
   // âŒ Ğ‘Ñ‹Ğ»Ğ¾
   List<Contract> findByActiveContractsForCarInPeriod(CarId carId, RentalPeriod period);
   
   // âœ… Ğ›ÑƒÑ‡ÑˆĞµ
   List<Contract> findActiveContractsForCarInPeriod(CarId carId, RentalPeriod period);
   ```

2. **ĞœĞµÑ‚Ğ¾Ğ´ `deleteById(ContractId)` Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ğ°Ğ¼ DDD**:
   - Ğ’ DDD Ğ¼Ñ‹ ĞĞ• ÑƒĞ´Ğ°Ğ»ÑĞµĞ¼ Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸
   - Ğ›ÑƒÑ‡ÑˆĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ soft delete
   ```java
   // âŒ Ğ£Ğ´Ğ°Ğ»ÑĞµÑ‚ Ñ„Ğ¸Ğ·Ğ¸Ñ‡ĞµÑĞºĞ¸
   void deleteById(ContractId contractId);
   
   // âœ… Ğ›ÑƒÑ‡ÑˆĞµ Ğ²Ğ¾Ğ¾Ğ±Ñ‰Ğµ Ğ½Ğµ Ğ¸Ğ¼ĞµÑ‚ÑŒ ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ°
   // Ğ˜Ğ»Ğ¸ Ğ¿ĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²:
   void softDelete(ContractId contractId);
   ```

3. **ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿Ñ€Ğ°Ğ² Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ°**:
   ```java
   // âœ… Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ¾Ñ‚ Ğ¼ĞµÑ‚Ğ¾Ğ´
   Optional<Contract> findByIdAndClientId(ContractId contractId, ClientId clientId);
   ```

**ĞÑ†ĞµĞ½ĞºĞ° ContractDomainRepository: 8/10** âœ… ĞŸĞ¾Ñ‡Ñ‚Ğ¸ Ğ¸Ğ´ĞµĞ°Ğ»ÑŒĞ½Ğ¾!

---

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ContractRepositoryAdapter

**Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´:**
```java
@Repository
@RequiredArgsConstructor
public class ContractRepositoryAdapter implements ContractDomainRepository {
    private final ContractMapper mapper;
    private final ContractRepository jpaRepository;

    @Override
    public Contract save(Contract contract) {
        // Ğ´Ğ¾Ğ¼ĞµĞ½ -> Ğ´Ğ¶Ğ¿Ğ° ĞµĞ½Ñ‚Ğ¸Ñ‚Ğ¸
        ContractJpaEntity contractJpaEntity = mapper.toEntity(contract);
        // ÑĞ°Ğ¹Ğ²Ğ°
        ContractJpaEntity savedEntity = jpaRepository.save(contractJpaEntity);
        // Ğ´Ğ¶Ğ¿Ğ° ĞµĞ½Ñ‚Ğ¸Ñ‚Ğ¸ -> Ğ´Ğ¾Ğ¼ĞµĞ½
        return mapper.toDomain(savedEntity);
    }

    @Override
    public Optional<Contract> findById(ContractId contractId) {
        // Ğ¶Ğ¿Ğ° Ğ¿Ğ¾ id
        Optional<ContractJpaEntity> optionalContractJpaEntity = jpaRepository.findById(contractId.value());
        // Ğ¼Ğ°Ğ¿Ğ¸Ğ½Ğ³ Ğ² Ğ´Ğ¾Ğ¼ĞµĞ½
        return optionalContractJpaEntity.map(mapper::toDomain);
    }

    @Override
    public Page<Contract> findByClientId(ClientId clientId, Pageable pageable) {
        Page<ContractJpaEntity> contractJpaEntityPage = jpaRepository.findByClientId(clientId.value(), pageable);
        return contractJpaEntityPage.map(mapper::toDomain);
    }

    @Override
    public List<Contract> findOverlappingContracts(RentalPeriod rentalPeriod, CarId carId, ContractId excludeContractId) {
        List<ContractJpaEntity> contractJpaEntities = jpaRepository.findOverlappingContracts(
                rentalPeriod.getStartDate(),
                rentalPeriod.getEndDate(),
                carId.value(),
                excludeContractId != null ? excludeContractId.value() : null
        );
        return contractJpaEntities.stream().map(mapper::toDomain).toList();
    }

    @Override
    public List<Contract> findByActiveContractsForCarInPeriod(CarId carId, RentalPeriod period) {
        List<ContractJpaEntity> contractJpaEntities = jpaRepository.findByActiveContractsForCarInPeriod(
                period.getStartDate(),
                period.getEndDate(),
                carId.value(),
                null
        );
        return contractJpaEntities.stream().map(mapper::toDomain).toList();
    }

    @Override
    public void deleteById(ContractId contractId) {
        ContractJpaEntity contractJpaEntity = jpaRepository.findById(contractId.value()).orElseThrow(
                () -> new NotFoundException("Contract not found with id: " + contractId.value()));

        mapper.toDomain(contractJpaEntity).cancel();
        jpaRepository.save(contractJpaEntity);
    }
}
```

#### âœ… Ğ§Ñ‚Ğ¾ ĞĞ¢Ğ›Ğ˜Ğ§ĞĞ:

1. **save() Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾**:
   ```java
   ContractJpaEntity contractJpaEntity = mapper.toEntity(contract);  // âœ… Domain -> JPA
   ContractJpaEntity savedEntity = jpaRepository.save(contractJpaEntity);  // âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ
   return mapper.toDomain(savedEntity);  // âœ… JPA -> Domain
   ```
   **ĞœĞĞ›ĞĞ”Ğ•Ğ¦!** Ğ­Ñ‚Ğ¾ 100% Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ!

2. **findById() Ğ¸Ğ´ĞµĞ°Ğ»ĞµĞ½**:
   ```java
   return jpaRepository.findById(contractId.value())
       .map(mapper::toDomain);  // âœ… Ğ­Ğ»ĞµĞ³Ğ°Ğ½Ñ‚Ğ½Ñ‹Ğ¹ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³
   ```

3. **findByClientId() Ñ Ğ¿Ğ°Ğ³Ğ¸Ğ½Ğ°Ñ†Ğ¸ĞµĞ¹**:
   ```java
   Page<ContractJpaEntity> page = jpaRepository.findByClientId(clientId.value(), pageable);
   return page.map(mapper::toDomain);  // âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
   ```

4. **findOverlappingContracts()** - Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ñ€Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²Ñ‹Ğ²Ğ°ĞµÑ‚ Value Objects:
   ```java
   jpaRepository.findOverlappingContracts(
       rentalPeriod.getStartDate(),  // âœ… Ğ˜Ğ· Value Object
       rentalPeriod.getEndDate(),    // âœ…
       carId.value(),                // âœ…
       excludeContractId != null ? excludeContractId.value() : null  // âœ… Null-safe
   );
   ```

5. **Stream Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³**:
   ```java
   return contractJpaEntities.stream().map(mapper::toDomain).toList();  // âœ…
   ```

#### âŒ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ Ğ² deleteById():

```java
@Override
public void deleteById(ContractId contractId) {
    ContractJpaEntity contractJpaEntity = jpaRepository.findById(contractId.value()).orElseThrow(
            () -> new NotFoundException("Contract not found with id: " + contractId.value()));

    mapper.toDomain(contractJpaEntity).cancel();  // âŒ ĞĞ“Ğ ĞĞœĞĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ!
    jpaRepository.save(contractJpaEntity);        // âŒ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚Ğµ ĞĞ• Ğ¢Ğ!
}
```

**Ğ§Ğ¢Ğ ĞĞ• Ğ¢ĞĞš:**

1. **Ğ’Ñ‹ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚Ğµ `cancel()` Ğ½Ğ° domain Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğµ, Ğ½Ğ¾ ĞĞ• ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ!**
   ```java
   mapper.toDomain(contractJpaEntity).cancel();  // âŒ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ»Ğ¸ domain Ğ¾Ğ±ÑŠĞµĞºÑ‚, Ğ²Ñ‹Ğ·Ğ²Ğ°Ğ»Ğ¸ cancel(), ĞĞ...
   jpaRepository.save(contractJpaEntity);        // âŒ ...ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚Ğµ Ğ¡Ğ¢ĞĞ Ğ£Ğ® JPA entity Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹!
   ```

2. **Domain Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ğ±Ñ‹Ğ» Ğ¸Ğ·Ğ¼ĞµĞ½Ñ‘Ğ½, Ğ½Ğ¾ ÑÑ‚Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ĞĞ• Ğ¿Ğ¾Ğ¿Ğ°Ğ»Ğ¸ Ğ² JPA entity**
   - Ğ’Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ»Ğ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¹ domain Ğ¾Ğ±ÑŠĞµĞºÑ‚ Ñ‡ĞµÑ€ĞµĞ· `mapper.toDomain()`
   - Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¸ ĞµĞ³Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· `.cancel()`
   - ĞĞ ÑÑ‚Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ¾ÑÑ‚Ğ°Ğ»Ğ¸ÑÑŒ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ¸ ĞĞ• Ğ¿Ğ¾Ğ¿Ğ°Ğ»Ğ¸ Ğ² `contractJpaEntity`
   - Ğ’Ñ‹ ÑĞ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸ ÑÑ‚Ğ°Ñ€ÑƒÑ `contractJpaEntity` Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹

**ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞĞ¯ Ğ Ğ•ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ¯:**

```java
@Override
public void deleteById(ContractId contractId) {
    // 1. Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ JPA entity
    ContractJpaEntity contractJpaEntity = jpaRepository.findById(contractId.value())
        .orElseThrow(() -> new NotFoundException("Contract not found with id: " + contractId.value()));

    // 2. ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ² Domain
    Contract contract = mapper.toDomain(contractJpaEntity);
    
    // 3. Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ (Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ)
    contract.cancel();
    
    // 4. ĞšĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾ Ğ² JPA entity (Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑĞ¼Ğ¸!)
    ContractJpaEntity updatedEntity = mapper.toEntity(contract);
    
    // 5. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ½ÑƒÑ entity
    jpaRepository.save(updatedEntity);
}
```

**Ğ˜Ğ»Ğ¸ ĞµÑ‰Ñ‘ Ğ»ÑƒÑ‡ÑˆĞµ (Ñ‡ĞµÑ€ĞµĞ· Ğ¼ĞµÑ‚Ğ¾Ğ´ save):**

```java
@Override
public void deleteById(ContractId contractId) {
    // 1. Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ñ‡ĞµÑ€ĞµĞ· domain Ğ¼ĞµÑ‚Ğ¾Ğ´
    Contract contract = findById(contractId)
        .orElseThrow(() -> new NotFoundException("Contract not found with id: " + contractId.value()));
    
    // 2. Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµĞ¼ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ
    contract.cancel();
    
    // 3. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ñ‡ĞµÑ€ĞµĞ· domain Ğ¼ĞµÑ‚Ğ¾Ğ´ (Ğ¾Ğ½ ÑĞ´ĞµĞ»Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³)
    save(contract);
}
```

**Ğ•Ğ©Ğ Ğ›Ğ£Ğ§Ğ¨Ğ• - ĞĞ• Ğ”Ğ•Ğ›ĞĞ¢Ğ¬ Ğ­Ğ¢ĞĞ¢ ĞœĞ•Ğ¢ĞĞ” Ğ’ĞĞĞ‘Ğ©Ğ•:**

Ğ’ DDD Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ ĞĞ• Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¸Ğ¼ĞµÑ‚ÑŒ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ (Ğ²Ñ‹Ğ·Ğ¾Ğ² `cancel()`).
Ğ­Ñ‚Ğ¾ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ Application Service:

```java
// Ğ’ ContractApplicationService
public void deleteContract(ContractId contractId) {
    Contract contract = contractRepository.findById(contractId)
        .orElseThrow(() -> new NotFoundException("Contract not found"));
    
    contract.cancel();  // Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ·Ğ´ĞµÑÑŒ
    contractRepository.save(contract);
}
```

Ğ Ğ¼ĞµÑ‚Ğ¾Ğ´ `deleteById` Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ²Ğ¾Ğ¾Ğ±Ñ‰Ğµ **ĞĞ• ĞĞ£Ğ–Ğ•Ğ** Ğ² DDD!

#### âš ï¸ ĞœĞ¸Ğ½Ğ¾Ñ€Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ:

1. **ĞĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚**:
   ```java
   import java.time.LocalDateTime;  // âŒ ĞĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ, ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚Ğµ
   ```

2. **ĞšĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğ½Ğ° Ñ€ÑƒÑÑĞºĞ¾Ğ¼ Ñ Ğ¾Ğ¿ĞµÑ‡Ğ°Ñ‚ĞºĞ°Ğ¼Ğ¸**:
   ```java
   // ÑĞ°Ğ¹Ğ²Ğ°  // âŒ "ÑĞ°Ğ¹Ğ²Ğ°" -> "ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ"
   // Ğ¶Ğ¿Ğ° Ğ¿Ğ¾ id  // âŒ "Ğ¶Ğ¿Ğ°" -> "JPA"
   ```
   Ğ›ÑƒÑ‡ÑˆĞµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ°Ğ½Ğ³Ğ»Ğ¸Ğ¹ÑĞºĞ¸Ğµ ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ Ñ€ÑƒÑÑĞºĞ¸Ğµ.

**ĞÑ†ĞµĞ½ĞºĞ° ContractRepositoryAdapter: 8.5/10** âœ… ĞŸĞ¾Ñ‡Ñ‚Ğ¸ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾, Ğ½Ğ¾ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² `deleteById()`!

---

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ContractRepository (JPA)

**Ğ’Ğ°Ñˆ ĞºĞ¾Ğ´:**
```java
@Repository
public interface ContractRepository extends JpaRepository<ContractJpaEntity, Long> {
    @Query("""
    SELECT c FROM ContractJpaEntity c
    WHERE c.carId = :carId
      AND (:contractId IS NULL OR c.id <> :contractId)
      AND c.state IN ('BOOKED', 'ACTIVE', 'PENDING', 'CONFIRMED')
      AND (
        (c.period.startDate < :endDate AND c.period.endDate > :startDate)
      )
    """)
    List<ContractJpaEntity> findOverlappingContracts(
            @Param("startDate") LocalDateTime startDate,
            @Param("endDate") LocalDateTime endDate,
            @Param("carId") Long carId,
            @Param("contractId") Long contractId
    );

    @Query("""
    SELECT c FROM ContractJpaEntity c
    WHERE c.carId = :carId
      AND (:contractId IS NULL OR c.id <> :contractId)
      AND c.state == 'ACTIVE'  // âŒ Ğ¡Ğ˜ĞĞ¢ĞĞšĞ¡Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ!
      AND (
        (c.period.startDate < :endDate AND c.period.endDate > :startDate)
      )
    """)
    List<ContractJpaEntity> findByActiveContractsForCarInPeriod(
            @Param("startDate") LocalDateTime startDate,
            @Param("endDate") LocalDateTime endDate,
            @Param("carId") Long carId,
            @Param("contractId") Long contractId
    );

    @Query("""
        SELECT c FROM ContractJpaEntity c
        WHERE c.clientId = :userId
          AND c.id = :contractId
    """)
    Optional<ContractJpaEntity> findByIdAndUserId(
        @Param("contractId") Long contractId, 
        @Param("userId") Long userId
    );
}
```

#### âœ… Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾:

1. **JPQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹** - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ âœ…
2. **Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ embedded Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ°Ğ¼Ğ¸** - `c.period.startDate` âœ…
3. **ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ğ¹ Ğ´Ğ°Ñ‚** - Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ âœ…
4. **Null-safe Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°** - `(:contractId IS NULL OR c.id <> :contractId)` âœ…

#### âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ Ğ² findByActiveContractsForCarInPeriod:

```java
AND c.state == 'ACTIVE'  // âŒ ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ! Ğ’ JPQL Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ¾Ğ´Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¾Ğµ =
```

**ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ:**
```java
AND c.state = 'ACTIVE'  // âœ… ĞĞ´Ğ¸Ğ½Ğ°Ñ€Ğ½Ñ‹Ğ¹ =
```

#### ğŸ¤” Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹:

1. **Ğ—Ğ°Ñ‡ĞµĞ¼ Ğ² `findByActiveContractsForCarInPeriod` Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ `:contractId`?**
   ```java
   // Ğ’Ñ‹ Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚Ğµ null Ğ² adapter:
   jpaRepository.findByActiveContractsForCarInPeriod(
       period.getStartDate(),
       period.getEndDate(),
       carId.value(),
       null  // â† Ğ—ĞĞ§Ğ•Ğœ ÑÑ‚Ğ¾Ñ‚ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€, ĞµÑĞ»Ğ¸ Ğ¾Ğ½ Ğ²ÑĞµĞ³Ğ´Ğ° null?
   );
   ```
   
   **Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ£Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ `:contractId` Ğ¸Ğ· ÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ°:
   ```java
   @Query("""
   SELECT c FROM ContractJpaEntity c
   WHERE c.carId = :carId
     AND c.state = 'ACTIVE'
     AND (c.period.startDate < :endDate AND c.period.endDate > :startDate)
   """)
   List<ContractJpaEntity> findByActiveContractsForCarInPeriod(
       @Param("startDate") LocalDateTime startDate,
       @Param("endDate") LocalDateTime endDate,
       @Param("carId") Long carId
   );
   ```

2. **ĞœĞµÑ‚Ğ¾Ğ´ `findByClientId` Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚**:
   - Ğ’Ñ‹ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚Ğµ ĞµĞ³Ğ¾ Ğ² adapter:
     ```java
     jpaRepository.findByClientId(clientId.value(), pageable);
     ```
   - ĞĞ¾ Ğ² Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹ÑĞµ `ContractRepository` ĞµĞ³Ğ¾ ĞĞ•Ğ¢!
   
   **Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´:
   ```java
   Page<ContractJpaEntity> findByClientId(Long clientId, Pageable pageable);
   ```
   
   Ğ˜Ğ»Ğ¸ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Spring Data Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ±ĞµĞ· @Query - Ğ¾Ğ½ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸.

**ĞÑ†ĞµĞ½ĞºĞ° ContractRepository (JPA): 7/10** âš ï¸ Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, Ğ½Ğ¾ ĞµÑÑ‚ÑŒ ÑĞ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ¸ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¼ĞµÑ‚Ğ¾Ğ´.

---

## ğŸ“Š Ğ˜Ğ¢ĞĞ“ĞĞ’ĞĞ¯ ĞĞ¦Ğ•ĞĞšĞ Ğ’ĞĞ¨Ğ•Ğ™ Ğ Ğ•ĞĞ›Ğ˜Ğ—ĞĞ¦Ğ˜Ğ˜

### ContractDomainRepository: **8/10** âœ…
- âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ñ‹ Ñ Value Objects
- âœ… Optional, Page, List
- âš ï¸ ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¼ĞµÑ‚Ğ¾Ğ´Ğ° Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğµ
- âš ï¸ `deleteById` Ğ½Ğµ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ DDD

### ContractRepositoryAdapter: **8.5/10** âœ…
- âœ… ĞÑ‚Ğ»Ğ¸Ñ‡Ğ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ save(), findById(), findByClientId()
- âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³ Domain â†” JPA
- âŒ **ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§Ğ•Ğ¡ĞšĞĞ¯ ĞĞ¨Ğ˜Ğ‘ĞšĞ** Ğ² deleteById() - Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ!
- âš ï¸ ĞĞ¿ĞµÑ‡Ğ°Ñ‚ĞºĞ¸ Ğ² ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸ÑÑ…

### ContractRepository (JPA): **7/10** âš ï¸
- âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğµ JPQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
- âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ¿ĞµÑ€ĞµÑĞµÑ‡ĞµĞ½Ğ¸Ğ¹
- âŒ Ğ¡Ğ¸Ğ½Ñ‚Ğ°ĞºÑĞ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° `==` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ `=`
- âŒ ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒĞµÑ‚ Ğ¼ĞµÑ‚Ğ¾Ğ´ `findByClientId`
- âš ï¸ Ğ›Ğ¸ÑˆĞ½Ğ¸Ğ¹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ Ğ² `findByActiveContractsForCarInPeriod`

### ĞĞ‘Ğ©ĞĞ¯ ĞĞ¦Ğ•ĞĞšĞ: **8/10** ğŸ‰

**Ğ’Ğ« ĞœĞĞ›ĞĞ”Ğ•Ğ¦!** Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ĞĞĞœĞĞĞ“Ğ Ğ»ÑƒÑ‡ÑˆĞµ Ñ‚Ğ¾Ğ³Ğ¾, Ñ‡Ñ‚Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ Ñ€Ğ°Ğ½ÑŒÑˆĞµ!

ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° - ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² `deleteById()`, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ¿Ñ€Ğ¸Ğ²ĞµĞ´Ñ‘Ñ‚ Ğº Ñ‚Ğ¾Ğ¼Ñƒ, Ñ‡Ñ‚Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ĞĞ• ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ² Ğ‘Ğ”.

---

## ğŸ”§ Ğ§Ğ¢Ğ ĞĞ£Ğ–ĞĞ Ğ˜Ğ¡ĞŸĞ ĞĞ’Ğ˜Ğ¢Ğ¬ Ğ¡Ğ ĞĞ§ĞĞ:

### 1. Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ deleteById Ğ² ContractRepositoryAdapter:

```java
@Override
public void deleteById(ContractId contractId) {
    // ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ«Ğ™ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: Ñ‡ĞµÑ€ĞµĞ· Ñ†Ğ¸ĞºĞ» Domain -> JPA
    Contract contract = findById(contractId)
        .orElseThrow(() -> new NotFoundException("Contract not found"));
    contract.cancel();
    save(contract);  // Ğ­Ñ‚Ğ¾ ÑĞ´ĞµĞ»Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼Ğ°Ğ¿Ğ¿Ğ¸Ğ½Ğ³
}
```

### 2. Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ JPQL Ğ² ContractRepository:

```java
// Ğ‘Ğ«Ğ›Ğ (ĞĞ•ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
AND c.state == 'ACTIVE'  // âŒ

// Ğ¡Ğ¢ĞĞ›Ğ (ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ):
AND c.state = 'ACTIVE'   // âœ…
```

### 3. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ findByClientId Ğ² ContractRepository:

```java
Page<ContractJpaEntity> findByClientId(Long clientId, Pageable pageable);
```

### 4. Ğ£Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ»Ğ¸ÑˆĞ½Ğ¸Ğ¹ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ Ğ¸Ğ· findByActiveContractsForCarInPeriod:

**Ğ’ ContractRepository (JPA):**
```java
@Query("""
SELECT c FROM ContractJpaEntity c
WHERE c.carId = :carId
  AND c.state = 'ACTIVE'
  AND (c.period.startDate < :endDate AND c.period.endDate > :startDate)
""")
List<ContractJpaEntity> findByActiveContractsForCarInPeriod(
    @Param("startDate") LocalDateTime startDate,
    @Param("endDate") LocalDateTime endDate,
    @Param("carId") Long carId
    // Ğ£Ğ±Ñ€Ğ°Ğ»Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ contractId
);
```

**Ğ’ ContractRepositoryAdapter:**
```java
@Override
public List<Contract> findByActiveContractsForCarInPeriod(CarId carId, RentalPeriod period) {
    List<ContractJpaEntity> contractJpaEntities = jpaRepository.findByActiveContractsForCarInPeriod(
        period.getStartDate(),
        period.getEndDate(),
        carId.value()
        // Ğ£Ğ±Ñ€Ğ°Ğ»Ğ¸ null
    );
    return contractJpaEntities.stream().map(mapper::toDomain).toList();
}
```

### 5. Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ½ĞµĞ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼Ñ‹Ğ¹ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚:

```java
import java.time.LocalDateTime;  // âŒ Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ¸Ğ· ContractRepositoryAdapter
```

---

## ğŸ’¡ Ğ Ğ•ĞšĞĞœĞ•ĞĞ”ĞĞ¦Ğ˜Ğ˜ Ğ”Ğ›Ğ¯ Ğ”ĞĞ›Ğ¬ĞĞ•Ğ™Ğ¨Ğ•Ğ“Ğ Ğ£Ğ›Ğ£Ğ§Ğ¨Ğ•ĞĞ˜Ğ¯:

### 1. Ğ£Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ deleteById Ğ¸Ğ· Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ

Ğ’ DDD Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ ĞĞ• Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ. ĞŸĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ĞºÑƒ Ğ² Application Service:

```java
// ContractApplicationService
@Transactional
public void deleteContract(ContractId contractId, ClientId clientId) {
    Contract contract = contractRepository.findByIdAndClientId(contractId, clientId)
        .orElseThrow(() -> new NotFoundException("Contract not found or access denied"));
    
    contract.cancel();  // Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
    contractRepository.save(contract);
}
```

### 2. Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´ findByIdAndClientId

**Ğ’ ContractDomainRepository:**
```java
Optional<Contract> findByIdAndClientId(ContractId contractId, ClientId clientId);
```

**Ğ’ ContractRepositoryAdapter:**
```java
@Override
public Optional<Contract> findByIdAndClientId(ContractId contractId, ClientId clientId) {
    return jpaRepository.findByIdAndUserId(contractId.value(), clientId.value())
        .map(mapper::toDomain);
}
```

### 3. ĞŸĞµÑ€ĞµĞ¸Ğ¼ĞµĞ½Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¼ĞµÑ‚Ğ¾Ğ´

```java
// Ğ‘Ñ‹Ğ»Ğ¾
List<Contract> findByActiveContractsForCarInPeriod(CarId carId, RentalPeriod period);

// Ğ›ÑƒÑ‡ÑˆĞµ
List<Contract> findActiveContractsForCarInPeriod(CarId carId, RentalPeriod period);
```

---

## âœ… Ğ˜Ğ¢ĞĞ“: Ğ’Ğ« ĞĞ ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞĞœ ĞŸĞ£Ğ¢Ğ˜!

Ğ’Ğ°ÑˆĞ° Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ĞµĞ² **ĞĞ§Ğ•ĞĞ¬ Ğ¥ĞĞ ĞĞ¨ĞĞ¯**! Ğ’Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚Ğµ Ğ¿Ñ€Ğ¸Ğ½Ñ†Ğ¸Ğ¿Ñ‹ DDD Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ¸Ñ… Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚Ğµ.

ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° - Ğ¾Ğ´Ğ½Ğ° ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² `deleteById()`, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ Ğ»ĞµĞ³ĞºĞ¾ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ÑÑ.

ĞŸĞ¾ÑĞ»Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¸Ñ… 5 Ğ¿ÑƒĞ½ĞºÑ‚Ğ¾Ğ² Ğ²Ğ°ÑˆĞ¸ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ½Ğ° **9.5/10**! ğŸš€

